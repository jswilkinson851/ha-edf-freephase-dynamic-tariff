# EDF FreePhase Dynamic Tariff â€” Entities Documentation (v0.7.1)

This document describes all entities created by the **EDF FreePhase Dynamic Tariff** integration as of **v0.7.1**.

The integration includes:
- A main data coordinator (EDFCoordinator)
- A cost engine (CostCoordinator)
- A binary sensor platform
- A debug logging switch
- A full event platform
- Expanded diagnostics and metadata
- A unified naming scheme for all entities

All prices use p/kWh unless stated otherwise.  
All cost values use GBP (Â£).  
All timestamps use ISO 8601.

---

# ðŸ“˜ Overview of Entity Types

The integration exposes:

- Pricing sensors  
- Cost sensors  
- Standing charge sensors  
- Slot & phase sensors  
- Binary sensors  
- Debug sensors  
- Health & metadata sensors  
- Scheduler timing sensors  
- Event entity (tariff transitions)

All entity IDs now follow:

- `<domain>.edf_fpd_<object_id>`

All friendly names begin with:

- `EDF FPD...`


---

# ðŸ”¹ Pricing Sensors

## **Current Price**
**Entity ID:** `sensor.edf_fpd_current_price`  
Shows the price of the current halfâ€‘hour slot.

**Attributes include:**
- start  
- end  
- duration_minutes  
- price_p_per_kwh  
- price_gbp_per_kwh  
- phase  
- icon  

---

## **Next Slot Price**
**Entity ID:** `sensor.edf_fpd_next_slot_price`  
Shows the price of the next halfâ€‘hour slot.

---

## **Cheapest Slot (Next 24 Hours)**
**Entity ID:** `sensor.edf_fpd_cheapest_slot`  
Shows the cheapest slot in the next 24 hours.

---

## **Most Expensive Slot (Next 24 Hours)**
**Entity ID:** `sensor.edf_fpd_most_expensive_slot`  
Shows the most expensive slot in the next 24 hours.

---

# ðŸ”¹ Standing Charge Sensor

## **Standing Charge**
**Entity ID:** `sensor.edf_fpd_standing_charge`  
Shows the daily standing charge for your region (inc VAT), in p/day.

**Attributes include:**
- inc_vat_p_per_day  
- exc_vat_p_per_day  
- gbp_per_day  
- valid_from  
- valid_to  
- raw (full EDF API response)  
- region  
- status  

---

# ðŸ”¹ Cost Sensors

These sensors use your electricity import sensor to calculate realâ€‘world costs.

## **Cost Today**
**Entity ID:** `sensor.edf_fpd_cost_today`  
Total cost from midnight to now.

---

## **Cost Yesterday**
**Entity ID:** `sensor.edf_fpd_cost_yesterday`  
Total cost for the previous day.

---

## **Cost Per Slot**
**Entity ID:** `sensor.edf_fpd_cost_per_slot`  
Breakdown of cost per halfâ€‘hour slot.

---

## **Cost Per Phase**
**Entity ID:** `sensor.edf_fpd_cost_per_phase`  
Cost grouped by phase (green/amber/red).

---

## **Total Cost Including Standing Charge**
**Entity ID:** `sensor.edf_fpd_total_cost_including_standing_charge`  
Full daily cost including standing charge.

---

# ðŸ”¹ Slot & Phase Sensors

## **Current Slot Colour**
**Entity ID:** `sensor.edf_fpd_current_slot_colour`  
Shows the colour (green/amber/red) of the current slot.

---

## **Current Phase Summary**
**Entity ID:** `sensor.edf_fpd_current_phase_summary`  
Shows the merged block of consecutive slots with the same phase.

---

## **Next Phase Summary**
**Entity ID:** `sensor.edf_fpd_next_phase_summary`  
Shows the next upcoming block of a different phase.

---

## **Next Green Slot**
**Entity ID:** `sensor.edf_fpd_next_green_slot`

## **Next Amber Slot**
**Entity ID:** `sensor.edf_fpd_next_amber_slot`

## **Next Red Slot**
**Entity ID:** `sensor.edf_fpd_next_red_slot`

Each shows the next slot of that colour.

---

# ðŸ”¹ Daily Summary Sensors

## **Todayâ€™s Phases Summary**
**Entity ID:** `sensor.edf_fpd_today_phases_summary`  
Shows todayâ€™s merged phase windows.

---

## **Tomorrowâ€™s Phases Summary**
**Entity ID:** `sensor.edf_fpd_tomorrow_phases_summary`  
Shows tomorrowâ€™s merged phase windows.

---

## **Yesterdayâ€™s Phases Summary**
**Entity ID:** `sensor.edf_fpd_yesterday_phases_summary`  
Shows yesterdayâ€™s merged phase windows.

---

# ðŸ”¹ Binary Sensors

## **Is Current Slot Green?**
**Entity ID:** `binary_sensor.edf_fpd_is_green_slot`  
True when the current slot is green.

---

# ðŸ”¹ Debug Sensors

## **Debug Logging Enabled**
**Entity ID:** `sensor.edf_fpd_debug_logging_enabled`  
Reflects the state of the debug logging switch.

---

## **EDFCoordinator Debug Buffer**
**Entity ID:** `sensor.edf_fpd_ec_debug_buffer`  
Shows the last 10 debug messages from the main coordinator.

---

## **CostCoordinator Debug Buffer**
**Entity ID:** `sensor.edf_fpd_cc_debug_buffer`  
Shows the last 10 debug messages from the cost engine.

---

# ðŸ”¹ Scheduler & Timing Sensors

## **Next Refresh Time**
**Entity ID:** `sensor.edf_fpd_next_refresh_time`  
Shows when the next aligned refresh will occur.

---

# ðŸ”¹ Health & Metadata Sensors

## **Coordinator Status**
**Entity ID:** `sensor.edf_fpd_cost_coordinator_status`  
Shows the overall health state:
- healthy  
- partial  
- stale  
- api_error  
- parsing_error  
- scheduler_error  
- etc.

---

## **API Latency**
**Entity ID:** `sensor.edf_fpd_api_latency`  
Roundâ€‘trip time to the EDF API.

---

## **Last Updated**
**Entity ID:** `sensor.edf_fpd_last_updated`  
When the coordinator last ran.

---

## **Last Successful Update**
**Entity ID:** `sensor.edf_fpd_last_successful_update`  
When fresh data was last retrieved.

---

## **Data Age**
**Entity ID:** `sensor.edf_fpd_data_age`  
Seconds since the last successful update.

---

## **Tariff Metadata**
Available in diagnostics:
- tariff_metadata  
- tariff_region_label  
- product_url  
- api_url  

---

# ðŸ”¹ Event Entity (UPDATED in v0.7.1)

## **Tariff Slot & Phase Events**
**Entity ID:** `event.edf_fpd_tariff_slot_phase_events`  
Emits structured events whenever the tariff changes.

### Event Types
- edf_fpd_slot_changed  
- edf_fpd_phase_changed  
- edf_fpd_phase_started  
- edf_fpd_phase_ended  
- edf_fpd_phase_block_changed  
- edf_fpd_next_phase_changed  
- edf_fpd_next_green_phase_changed  
- edf_fpd_next_amber_phase_changed  
- edf_fpd_next_red_phase_changed  
- edf_fpd_debug  

### Attributes
- last_event_type  
- last_event_timestamp  
- event_counts  
- event_history  

---

# ðŸ”¹ Switches

## **Debug Logging**
**Entity ID:** `switch.edf_fpd_debug_logging`  
Enables or disables structured debug logging without restarting Home Assistant.

---

# ðŸ“Œ Summary

This integration provides a complete set of tariff, cost, diagnostic, and eventâ€‘driven entities designed for dashboards, automations, and advanced energy management workflows.

All entities now follow the unified naming scheme introduced in **v0.7.1**, ensuring longâ€‘term stability and preparing the integration for future multiâ€‘tariff support.

---
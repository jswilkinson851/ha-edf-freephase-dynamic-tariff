# Daily EDF FreePhase Dynamic Energy Summary
#
# Description:
# Sends a daily notification summarising:
# - Todayâ€™s electricity cost (from the EDF FreePhase Dynamic tariff)
# - Solar generation (from GivTCP)
# - Grid import (from your import sensor or cost-per-phase sensor)
#
# Requirements:
# - sensor.edf_fpd_cost_today
# - sensor.<your_givtcp_pv_sensor>
# - sensor.edf_fpd_cost_per_phase  (or your own import sensor)
#
# Notes:
# - Replace the notify service with your own mobile app target.
# - Cost is already in GBP, so no conversion is needed.

alias: Daily EDF FPD Energy Summary
description: Combined cost, solar generation, and grid import summary at 20:00
triggers:
  - trigger: time
    at: "20:00:00"
actions:
  - action: notify.mobile_{device_name}
    data:
      title: "ğŸ”” Daily Energy Summary"
      message: |
        ğŸ’· Electricity cost so far: Â£{{ states('sensor.edf_fpd_cost_today') | float | round(2) }}
        â˜€ï¸ Solar generation today: {{ states('sensor.givtcp_{ge_serial_number}_pv_energy_today_kwh') | float | round(2) }} kWh
        ğŸ”Œ Grid import today: {{ states('sensor.edf_fpd_cost_per_phase') | float | round(2) }} kWh
mode: single
